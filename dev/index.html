<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · QGDipoles.jl</title><meta name="title" content="Home · QGDipoles.jl"/><meta property="og:title" content="Home · QGDipoles.jl"/><meta property="twitter:title" content="Home · QGDipoles.jl"/><meta name="description" content="Documentation for QGDipoles.jl."/><meta property="og:description" content="Documentation for QGDipoles.jl."/><meta property="twitter:description" content="Documentation for QGDipoles.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="QGDipoles.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>QGDipoles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#About"><span>About</span></a></li><li><a class="tocitem" href="#Method-Summary"><span>Method Summary</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li><li><a class="tocitem" href="Examples/">Examples</a></li><li><a class="tocitem" href="Functions/">List of Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mncrowe/QGDipoles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mncrowe/QGDipoles.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="QGDipoles.jl"><a class="docs-heading-anchor" href="#QGDipoles.jl">QGDipoles.jl</a><a id="QGDipoles.jl-1"></a><a class="docs-heading-anchor-permalink" href="#QGDipoles.jl" title="Permalink"></a></h1><p>Documentation and examples for QGDipoles.jl by <a href="https://mncrowe.github.io/">Matthew N. Crowe</a>.</p><h2 id="About"><a class="docs-heading-anchor" href="#About">About</a><a id="About-1"></a><a class="docs-heading-anchor-permalink" href="#About" title="Permalink"></a></h2><p>This Julia package provides functions for evaluating dipolar vortex solutions in the surface quasi-geostrophic (SQG) and multi-layer quasi-geostrophic (LQG) models. It is intended for use by those researching vortex dynamics in strongly rotating flows, in particular for researchers in physical oceanography and atmospheric dynamics. This package is based on the semi-analytic theory of dipolar vortices derived in Johnson &amp; Crowe 2023<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> and Crowe &amp; Johnson 2023<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> for SQG solutions and Crowe &amp; Johnson 2024<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> for LQG solutions. The method used a basis of orthogonal polynomials (Zernike radial functions) to convert a steady PDE into a linear algebra system which is solved using standard methods. This code consists of an updated version of the MATLAB code released as supplementary material with Crowe &amp; Johnson 2024<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> and incorporates (unreleased) functions for the SQG problem. For those interested in the original (LQG only) implementation, it can be found <a href="https://github.com/mncrowe/QGDipoles.m">here</a>.</p><h2 id="Method-Summary"><a class="docs-heading-anchor" href="#Method-Summary">Method Summary</a><a id="Method-Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Method-Summary" title="Permalink"></a></h2><p>The full method is outlined in Johnson &amp; Crowe 2023<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, Crowe &amp; Johnson 2023<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> and 2024<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup>. A summary is presented here such that the notation and examples presented later make some sense. We consider a dipolar vortex of radius <span>$\ell$</span>, moving with speed <span>$U$</span>. This vortex consists of an isolated region of high vorticity with a closed streamline at <span>$x^2 + y^2 = \ell^2$</span> (in a frame co-moving with the vortex), hence fluid does not escape during propagation. Within the vortex core, <span>$x^2 + y^2 &lt; \ell^2$</span>, are two counter rotating regions, corresponding to a dipole. The streamfunction describing the flow is denoted by <span>$\psi$</span> and potential vorticity (PV) anomaly by <span>$q$</span>. Velocities may be derived as <span>$(u, v) = (-\partial_y\psi, \partial_x\psi)$</span>. The streamfunction, <span>$\psi$</span>, and PV anomaly, <span>$q$</span>, are related through PV inversion. In the case of multiple layers, <span>$\psi$</span> and <span>$q$</span> are vector valued functions of length equal to the number of layers, <span>$N$</span>.</p><h3 id="Layered-Quasi-Geostrophic-(LQG)-Solutions"><a class="docs-heading-anchor" href="#Layered-Quasi-Geostrophic-(LQG)-Solutions">Layered Quasi-Geostrophic (LQG) Solutions</a><a id="Layered-Quasi-Geostrophic-(LQG)-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Layered-Quasi-Geostrophic-(LQG)-Solutions" title="Permalink"></a></h3><p>In the LQG model, steady, propagating, dipolar vortices satisfy the relation</p><p class="math-container">\[q_i + \beta_i y = F_i(\psi_i + Uy),\]</p><p>where <span>$\beta_i$</span> denotes the background PV gradient, <span>$i \in [1,\dots,N]$</span> is the layer index and <span>$F_i$</span> is an arbitrary (piecewise continuous) function. To proceed, we assume that <span>$F_i(z) = (\beta_i/U) z$</span> for <span>$x^2 + y^2 &gt; \ell^2$</span> (outside the vortex) and <span>$F_i(z) = -(K_i^2/\ell^2) z$</span> for <span>$x^2 + y^2 &lt; \ell^2$</span> (inside the vortex). Using a Hankel transform and expansion in term of Zernike radial functions, the problem may be reduced to the linear algebra system</p><p class="math-container">\[\left[ \textbf{A} -  \sum _{n = 1}^N K_n^2\textbf{B}_n \right] \textbf{a} = \textbf{c}_0 + \sum _{n = 1}^N K_n^2 \textbf{c}_n,\]</p><p>where <span>$\textbf{A}$</span> and <span>$\textbf{B}_n$</span> are matrices, <span>$\textbf{a}$</span> is a vector containing the coefficients in the polynomial expansion, <span>$\textbf{c}_j$</span> are vectors and the <span>$K_n$</span> are defined in <span>$F_i$</span> above and appear as unknown eigenvalues in the linear problem. In order to solve the system, <span>$N$</span> additional conditions are required. These are <span>$\textbf{d}_n \cdot textbf{a} = 0$</span> for <span>$n \in [1, \dots, N]$</span> where the <span>$\textbf{d}_n$</span> are vectors. These conditions correspond to the requirement that the streamfunction and vorticity are continuous in each layer. In principal, we have an infinite number of coefficients in <span>$\textbf{a}$</span>. However, since we know that these coefficients must decay with increasing index (since <span>$\psi$</span> is continuous), we can truncate the expansion after <span>$M$</span> terms. The resulting linear system is of size <span>$MN \times MN$</span>.</p><p>Solving this system determines the expansion coefficients and eigenvalues and hence allows <span>$\psi$</span> and <span>$q$</span> to be evaluated on any given spatial grid. In the one-layer case the problem reduces to known analytical solutions, such as the Lamb-Chaplygin dipole<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup> and the Larichev-Reznik dipole<sup class="footnote-reference"><a id="citeref-5" href="#footnote-5">[5]</a></sup>.</p><h3 id="Surface-Quasi-Geostrophic-(SQG)-Solutions"><a class="docs-heading-anchor" href="#Surface-Quasi-Geostrophic-(SQG)-Solutions">Surface Quasi-Geostrophic (SQG) Solutions</a><a id="Surface-Quasi-Geostrophic-(SQG)-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-Quasi-Geostrophic-(SQG)-Solutions" title="Permalink"></a></h3><p>In the SQG model, steady, propagating, dipolar vortices satisfy the relation</p><p class="math-container">\[\left[\partial_z + \frac{1}{R&#39;}\right] \psi = F(\psi + Uy),\]</p><p>where</p><p class="math-container">\[\partial_z = \sqrt{-\nabla^2 + \beta/U} \hspace{5pt} \tanh \left[R \sqrt{-\nabla^2 + \beta/U} \right],\]</p><p>is a Dirichlet-Neumann operator linking the surface streamfunction, <span>$\psi$</span>, and the surface buoyancy, <span>$b = \partial_z \psi$</span>. Here, <span>$(R, R&#39;)$</span> describes the baroclinic and barotropic Rossby radii and <span>$\beta$</span> is the background vorticity gradient. We assume that <span>$F(z) = 0$</span> for <span>$x^2 + y^2 &gt; \ell^2$</span> (outside the vortex) and <span>$F_i(z) = -(K/\ell) z$</span> for <span>$x^2 + y^2 &lt; \ell^2$</span>. Using a Hankel transform and expansion in term of Zernike radial functions, the problem may be reduced to the linear algebra system</p><p class="math-container">\[\left[ \textbf{A} -  K\textbf{B} \right] \textbf{a} = \textbf{c}_0 + K \textbf{c}_1,\]</p><p>where <span>$\textbf{A}$</span> and <span>$\textbf{B}$</span> are matrices, <span>$\textbf{c}_i$</span> are vectors, <span>$\textbf{a}$</span> is a vector of coefficients and <span>$K$</span> is an eigenvalue related to <span>$F$</span>. An additional condition is required to solve this system for a unique set of <span>$K$</span>. This condition is taken to be continuity across the vortex boundary and corresponds to <span>$\textbf{d} \cdot \textbf{a} = 0$</span> for some vector <span>$\textbf{d}$</span>. In principal, we have an infinite number of coefficients in <span>$\textbf{a}$</span>. However, since we know that these coefficients must decay with increasing index (since <span>$\psi$</span> is continuous), we can truncate the expansion after <span>$M$</span> terms. The resulting linear system is of size <span>$M \times M$</span>.</p><p>Solving this linear system allows the surface streamfunction, <span>$\psi$</span>, and surface bouyancy, <span>$b$</span>, to be calculated.</p><h3 id="Solving-the-Linear-System"><a class="docs-heading-anchor" href="#Solving-the-Linear-System">Solving the Linear System</a><a id="Solving-the-Linear-System-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-Linear-System" title="Permalink"></a></h3><p>Consider the multi-parameter, inhomogeneous eigenvalue problem</p><p class="math-container">\[\left[ \textbf{A} -  \sum _{n = 1}^N K_n^m\textbf{B}_n \right] \textbf{a} = \textbf{c}_0 + \sum _{n = 1}^N K_n^m \textbf{c}_n, \quad \textrm{s.t.} \quad \textbf{d}_n \cdot \textbf{a} = 0 \quad \textrm{for} \quad n \in [1, \dots N],\]</p><p>which describes both the SQG (<span>$m, N = 1$</span>) and LQG (<span>$m = 2$</span>) systems. For <span>$N = 1$</span>, this system may be converted into a quadratic eigenvalue problem and solved by standard techniques. For <span>$N &gt; 1$</span>, existing techniques scale poorly with matrix size so we take an alternative approach and find <span>$(K, \textbf{a})$</span> using a root finding method, where the orthogonality conditions (<span>$\textbf{d}_n \cdot \textbf{a} = 0$</span>) are used to reduce the dimension of the space. These two approaches are described in the Appendix of Crowe &amp; Johnson 2024<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup>.</p><h3 id="Recovering-the-Vortex-Solution"><a class="docs-heading-anchor" href="#Recovering-the-Vortex-Solution">Recovering the Vortex Solution</a><a id="Recovering-the-Vortex-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Recovering-the-Vortex-Solution" title="Permalink"></a></h3><p>Once the coefficients are determined, they are multiplied by the basis polynomials and summed on a specified numerical grid to give an intermediate field, <span>$\textbf{F}$</span>. The streamfunction, <span>$\psi$</span>, potential vorticity anomaly, <span>$q$</span> (LQG), and surface buoyancy, <span>$b$</span> (SQG), are related to <span>$\textbf{F}$</span> by differential operators and may be calculated using discrete Fourier transforms. Note that the streamfunction may decay slowly in the far-field for certain parameters so a sufficiently large domain is required to avoid Gibbs phenemenon near the domain edges.</p><h3 id="Integration-with-GeophysicalFlows.jl"><a class="docs-heading-anchor" href="#Integration-with-GeophysicalFlows.jl">Integration with GeophysicalFlows.jl</a><a id="Integration-with-GeophysicalFlows.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-GeophysicalFlows.jl" title="Permalink"></a></h3><p>This package is designed to work with the <code>TwoDGrid</code> structure from <code>FourierFlows.jl</code> and <code>GeophysicalFlows.jl</code><sup class="footnote-reference"><a id="citeref-6" href="#footnote-6">[6]</a></sup>. As such, these functions may be used to define initial conditions for layered and surface quasi-geostrophic simulations which may run on either CPUs or GPUs. However, <code>FourierFlows.jl</code> and <code>GeophysicalFlows.jl</code> are NOT required to use this package as an alternative grid structure (created using <code>CreateGrid</code>), which uses the same field names as <code>FourierFlows.jl</code>, is available.</p><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><p>This appendix contains a summary of the LQG and SQG systems of equations and tables which summarise all parameters used in functions and structures of QGDipoles.jl. This appendix also contains an index of all functions and structures.</p><h3 id="The-LQG-System"><a class="docs-heading-anchor" href="#The-LQG-System">The LQG System</a><a id="The-LQG-System-1"></a><a class="docs-heading-anchor-permalink" href="#The-LQG-System" title="Permalink"></a></h3><p>The layered QG equations are</p><p class="math-container">\[
(\partial_t - U \partial_x) q_i + J(\psi_i,q_i) + \beta_i \partial_x \psi_i = 0, \quad i \in \{1,2,\dots, N\},
\]</p><p>where the potential vorticity in each layer, <span>$q_i$</span>, is given in terms of the streamfunction in each layer, <span>$\psi_i$</span>, by</p><p class="math-container">\[
\begin{align*}
q_1 = &amp;\, \nabla^2 \psi_1 + R_1^{-2} (\psi_2 - \psi_1),\\
q_i = &amp;\, \nabla^2 \psi_i + R_i^{-2} (\psi_{i-1}-2\,\psi_i+\psi_{i+1}), \quad i \in \{2,\dots N-1\},\\
q_N = &amp;\, \nabla^2 \psi_N  + R_N^{-2} (\psi_{N-1}-\psi_N),
\end{align*}
\]</p><p>and <span>$R_i = \sqrt{g&#39;H_i}/f$</span> is the Rossby radius of deformation in each layer. The full list of parameters for the LQG system is given in the table below.</p><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th><th style="text-align: left">Definition</th></tr><tr><td style="text-align: left"><span>$U$</span></td><td style="text-align: left">vortex speed</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$\ell$</span></td><td style="text-align: left">vortex radius</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$\beta$</span></td><td style="text-align: left">background (y) vorticity gradient in each layer</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$R$</span></td><td style="text-align: left">Rossby radius in each layer</td><td style="text-align: left"><span>$R_i = \sqrt {g&#39;H_i} / f$</span></td></tr><tr><td style="text-align: left"><span>$\lambda$</span></td><td style="text-align: left">ratio of radius to <span>$R$</span> in each layer</td><td style="text-align: left"><span>$\lambda_i = \ell / R_i$</span></td></tr><tr><td style="text-align: left"><span>$\mu$</span></td><td style="text-align: left">rescaled vorticity gradient</td><td style="text-align: left"><span>$\mu_i = \beta_i \ell^2 / U$</span></td></tr><tr><td style="text-align: left"><span>$\alpha$</span></td><td style="text-align: left">angle of vortex propagation</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$x_0$</span></td><td style="text-align: left">position of vortex center</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$N$</span></td><td style="text-align: left">number of layers</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$M$</span></td><td style="text-align: left">number of terms in polynomial expansion</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$g&#39;$</span></td><td style="text-align: left">buoyancy difference between each layer</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$f$</span></td><td style="text-align: left">Coriolis parameters</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$H$</span></td><td style="text-align: left">layer depth in each layer</td><td style="text-align: left">-</td></tr></table><h3 id="The-SQG-System"><a class="docs-heading-anchor" href="#The-SQG-System">The SQG System</a><a id="The-SQG-System-1"></a><a class="docs-heading-anchor-permalink" href="#The-SQG-System" title="Permalink"></a></h3><p>The 3D QG equations are</p><p class="math-container">\[
(\partial_t - U \partial_x) q + J(\psi,q) + \beta \partial_x \psi = 0, \quad \textrm{for} \quad z \in [-R, 0],
\]</p><p>where</p><p class="math-container">\[
q = \left[\frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2}\right] \psi, \quad \textrm{for} \quad z \in [-R, 0],
\]</p><p>and <span>$R = NH/f$</span> is the Baroclinic Rossby radius. Note that we have rescaled <span>$z$</span> by <span>$N/f$</span> so <span>$q$</span> and <span>$\psi$</span> are related by the 3D Laplacian operator. The top boundary condition is taken to be</p><p class="math-container">\[
(\partial_t - U \partial_x) [b + N^2 \eta] + J(\psi, b + N^2 \eta) = 0, \quad \textrm{on} \quad z  = 0,
\]</p><p>and we assume that <span>$b = 0$</span> on the bottom surface, <span>$z = -R$</span>. Here, <span>$b = N \partial\psi/\partial z$</span> is the buoyancy and <span>$\eta = f\psi/g$</span> is the surface elevation.</p><p>The SQG system is typically derived by assuming that <span>$q = 0$</span> in the interior. We instead take <span>$q = (\beta/U)\psi$</span> which satisfies the steady evolution equation for <span>$q$</span> given above and reduces to the usual result for <span>$\beta = 0$</span>. Since <span>$b(z = 0)$</span> can be determined from <span>$\psi(z = 0)$</span> using the Dirichlet-Neumann operator given above, this system reduces to a 2D system for the modified surface buoyancy, <span>$b + N^2 \eta$</span>, only.</p><p>QGDipoles.jl solves for steady, dipolar solutions to this surface equation and hence calculates only the surface values of <span>$b$</span> and <span>$\psi$</span>. If a 3D solution is required, a layered model with a large number of layers is recommended. The full list of parameters for the SQG system is given in the table below.</p><p>Note: this package returns <span>$b/N$</span> rather than <span>$b$</span>. When working with dimensional variables, this factor of <span>$1/N$</span> should be included manually.</p><table><tr><th style="text-align: left">Parameter</th><th style="text-align: left">Description</th><th style="text-align: left">Definition</th></tr><tr><td style="text-align: left"><span>$U$</span></td><td style="text-align: left">vortex speed</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$\ell$</span></td><td style="text-align: left">vortex radius</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$\beta$</span></td><td style="text-align: left">background (y) vorticity gradient in each layer</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$R$</span></td><td style="text-align: left">baroclinic Rossby radius</td><td style="text-align: left"><span>$R = NH / f$</span></td></tr><tr><td style="text-align: left"><span>$R&#39;$</span></td><td style="text-align: left">reduced barotropic Rossby radius</td><td style="text-align: left"><span>$R&#39; = R_0^2 / R$</span></td></tr><tr><td style="text-align: left"><span>$\lambda$</span></td><td style="text-align: left">ratio of radius to <span>$R$</span></td><td style="text-align: left"><span>$\lambda = \ell / R$</span></td></tr><tr><td style="text-align: left"><span>$\mu$</span></td><td style="text-align: left">rescaled vorticity gradient</td><td style="text-align: left"><span>$\mu = \beta \ell^2 / U$</span></td></tr><tr><td style="text-align: left"><span>$\alpha$</span></td><td style="text-align: left">angle of vortex propagation</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$x_0$</span></td><td style="text-align: left">position of vortex center</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$M$</span></td><td style="text-align: left">number of terms in polynomial expansion</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$N$</span></td><td style="text-align: left">buoyancy frequency</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$R_0$</span></td><td style="text-align: left">barotropic Rossby radius</td><td style="text-align: left"><span>$R_0 = \sqrt {gH} / f$</span></td></tr><tr><td style="text-align: left"><span>$g$</span></td><td style="text-align: left">gravitational acceleration</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$f$</span></td><td style="text-align: left">Coriolis parameters</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><span>$H$</span></td><td style="text-align: left">layer depth</td><td style="text-align: left">-</td></tr></table><h3 id="Index-of-Functions"><a class="docs-heading-anchor" href="#Index-of-Functions">Index of Functions</a><a id="Index-of-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Index-of-Functions" title="Permalink"></a></h3><p>This list contains all Functions and Structures from the <code>QGDipoles.jl</code> package. Full descriptions can be found on the <a href="https://mncrowe.github.io/QGDipoles.jl/dev/Functions/">List of Functions</a> page.</p><table><tr><th style="text-align: left">Name</th><th style="text-align: left">Location</th><th style="text-align: left">Type</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>A_func</code></td><td style="text-align: left"><code>src/JJ_integ.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Evaluates a function required to calculate the matrix <span>$\textbf{A}$</span> in the LQG case</td></tr><tr><td style="text-align: left"><code>B_func</code></td><td style="text-align: left"><code>src/JJ_integ.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Evaluates a function required to calculate the matrix <span>$\textbf{B}$</span> in the LQG case</td></tr><tr><td style="text-align: left"><code>JJ_int</code></td><td style="text-align: left"><code>src/JJ_integ.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Calculates a double Bessel function integral required to calculate <span>$\textbf{A}$</span> and <span>$\textbf{B}$</span></td></tr><tr><td style="text-align: left"><code>BuildLinSys</code></td><td style="text-align: left"><code>src/lin_sys.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Builds the terms in the inhomogeneous eigenvalue problem; <span>$\textbf{A}$</span>, <span>$\textbf{B}$</span>, <span>$\textbf{c}$</span> and <span>$\textbf{d}$</span></td></tr><tr><td style="text-align: left"><code>ApplyPassiveLayers</code></td><td style="text-align: left"><code>src/lin_sys.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Removes rows and columns corresponding to passive layers from the linear system</td></tr><tr><td style="text-align: left"><code>IncludePassiveLayers</code></td><td style="text-align: left"><code>src/lin_sys.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Includes columns corresponding to passive layers in the eigenvalue and coefficient arrays</td></tr><tr><td style="text-align: left"><code>SolveInhomEVP</code></td><td style="text-align: left"><code>src/lin_sys.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Solves the inhomogeneous eigenvalue problem using nonlinear root finding (<span>$N &gt; 1$</span>) or standard eigenvalue methods for quadratic problems (<span>$N = 1$</span>)</td></tr><tr><td style="text-align: left"><code>InhomEVP_F!</code></td><td style="text-align: left"><code>src/lin_sys.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Calculates the function required for <code>SolveInhomEVP</code> and it&#39;s derivatives</td></tr><tr><td style="text-align: left"><code>OrthogSpace</code></td><td style="text-align: left"><code>src/lin_sys.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Extends the input to an orthonormal basis over <span>$R^n$</span> using the Gram-Schmidt method, required for <code>SolveInhomEVP</code></td></tr><tr><td style="text-align: left"><code>ZernikeR</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Define the Zernike radial function using the <code>jacobi</code> function from <code>SpecialFunctions.jl</code></td></tr><tr><td style="text-align: left"><code>GridStruct</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Structure</td><td style="text-align: left">A structure that stores the grid variables in physical and Fourier space</td></tr><tr><td style="text-align: left"><code>CreateGrid</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Define the numerical grid in the form of a <code>GridStruct</code> structure</td></tr><tr><td style="text-align: left"><code>Calc_ψq</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Calculate <span>$\psi$</span> and <span>$q$</span> in a layered QG model using coefficients and vortex parameters</td></tr><tr><td style="text-align: left"><code>Calc_ψb</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Calculate <span>$\psi$</span> and <span>$b$</span> in the SQG model using coefficients and vortex parameters</td></tr><tr><td style="text-align: left"><code>Calc_uv</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Calculate the velocity fields from <span>$\psi$</span> using <span>$(u, v) = (-\partial\psi/\partial y, \partial\psi/\partial x)$</span></td></tr><tr><td style="text-align: left"><code>ΔNCalc</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">Defines a matrix used to invert for <span>$\psi$</span> and <span>$q$</span> in Fourier space</td></tr><tr><td style="text-align: left"><code>CreateModonLQG</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">High level wrapper function for calculating <span>$\psi$</span>, <span>$q$</span>, <span>$K$</span> and <span>$\textbf{a}$</span> for the Layered QG model using given parameters</td></tr><tr><td style="text-align: left"><code>CreateModonSQG</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">High level wrapper function for calculating <span>$\psi$</span>, <span>$b$</span>, <span>$K$</span> and <span>$\textbf{a}$</span> for the SQG model using given parameters</td></tr><tr><td style="text-align: left"><code>CreateLCD</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">High level wrapper function for calculating <span>$\psi$</span>, <span>$q$</span> and <span>$K$</span> for the Lamb-Chaplygin dipole using given parameters</td></tr><tr><td style="text-align: left"><code>CreateLRD</code></td><td style="text-align: left"><code>src/create_modon.jl</code></td><td style="text-align: left">Function</td><td style="text-align: left">High level wrapper function for calculating <span>$\psi$</span>, <span>$q$</span> and <span>$K$</span> for the Larichev-Reznik dipole using given parameters</td></tr></table><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://doi.org/10.1017/jfm.2023.87">Johnson, E. R., and M. N. Crowe, 2023, Oceanic dipoles in a surface quasigeostrophic model, J. Fluid Mech., 958, R2</a>.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><a href="https://doi.org/10.1017/jfm.2023.607">Crowe, M. N., and E. R. Johnson, 2023, The evolution of surface quasi-geostrophic modons on sloping topography, J. Fluid. Mech., 970, A10</a>.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a><a href="https://doi.org/10.1017/jfm.2024.619">Crowe, M. N., and E. R. Johnson, 2024, Modon solutions in an N-layer quasi-geostrophic model, J. Fluid. Mech., 994, R1</a>.</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a><a href="https://archive.org/details/hydrodynamics00lamb">Lamb, H., 1932, Hydrodynamics. Cambridge University Press</a>.</li><li class="footnote" id="footnote-5"><a class="tag is-link" href="#citeref-5">5</a><a href="https://www.researchgate.net/publication/248173065_Two-dimensional_solitary_Rossby_waves">Larichev, V.D. &amp; Reznik, G.M., 1976, Two-dimensional solitary Rossby waves, Dokl. Akad. Nauk SSSR, 12–13</a>.</li><li class="footnote" id="footnote-6"><a class="tag is-link" href="#citeref-6">6</a><a href="https://joss.theoj.org/papers/10.21105/joss.03053">Constantinou et al., 2021, GeophysicalFlows.jl: Solvers for geophysical fluid dynamics problems in periodic domains on CPUs &amp; GPUs, JOSS, 6(60), 3053</a>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="Examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 4 November 2024 21:06">Monday 4 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
